import{s as se,Q as N,R as Z,p as $,U as it,S as Pe,B as Me,u as ie,v as re,w as ce,x as le,V as Ct,W as Rt,l as Ve,m as Be,i as qe,d as Ge,T as Dt}from"./scheduler.0qp6M-Pl.js";import{S as ue,i as fe,c as X,b as F,m as W,a as D,t as I,d as V,f as It}from"./index.q5A7eL_d.js";import{q as Lt,r as St,s as kt,t as Nt,V as O,v as H,w as K,Q as _e,x as Qe,y as R,a as ee,g as Te,h as we,i as Yt,u as zt,p as rt,j as Oe,z as xt,F as Je,G as ve,M as ye,H as $e,I as Ut,J as Ht}from"./index.Tiuvjvbr.js";const et={type:"change"},Ee={type:"start"},tt={type:"end"},ae=new Lt,nt=new St,Kt=Math.cos(70*kt.DEG2RAD);let Zt=class extends Nt{constructor(o,r){super(),this.object=o,this.domElement=r,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new O,this.cursor=new O,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:H.ROTATE,MIDDLE:H.DOLLY,RIGHT:H.PAN},this.touches={ONE:K.ROTATE,TWO:K.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return i.phi},this.getAzimuthalAngle=function(){return i.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",be),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",be),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(et),e.update(),a=n.NONE},this.update=function(){const t=new O,l=new _e().setFromUnitVectors(o.up,new O(0,1,0)),m=l.clone().invert(),h=new O,w=new _e,Y=new O,j=2*Math.PI;return function(jt=null){const Fe=e.object.position;t.copy(Fe).sub(e.target),t.applyQuaternion(l),i.setFromVector3(t),e.autoRotate&&a===n.NONE&&G(lt(jt)),e.enableDamping?(i.theta+=c.theta*e.dampingFactor,i.phi+=c.phi*e.dampingFactor):(i.theta+=c.theta,i.phi+=c.phi);let L=e.minAzimuthAngle,S=e.maxAzimuthAngle;isFinite(L)&&isFinite(S)&&(L<-Math.PI?L+=j:L>Math.PI&&(L-=j),S<-Math.PI?S+=j:S>Math.PI&&(S-=j),L<=S?i.theta=Math.max(L,Math.min(S,i.theta)):i.theta=i.theta>(L+S)/2?Math.max(L,i.theta):Math.min(S,i.theta)),i.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,i.phi)),i.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(_,e.dampingFactor):e.target.add(_),e.target.sub(e.cursor),e.target.clampLength(e.minTargetRadius,e.maxTargetRadius),e.target.add(e.cursor);let J=!1;if(e.zoomToCursor&&z||e.object.isOrthographicCamera)i.radius=he(i.radius);else{const k=i.radius;i.radius=he(i.radius*p),J=k!=i.radius}if(t.setFromSpherical(i),t.applyQuaternion(m),Fe.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(c.theta*=1-e.dampingFactor,c.phi*=1-e.dampingFactor,_.multiplyScalar(1-e.dampingFactor)):(c.set(0,0,0),_.set(0,0,0)),e.zoomToCursor&&z){let k=null;if(e.object.isPerspectiveCamera){const v=t.length();k=he(v*p);const oe=v-k;e.object.position.addScaledVector(B,oe),e.object.updateMatrixWorld(),J=!!oe}else if(e.object.isOrthographicCamera){const v=new O(d.x,d.y,0);v.unproject(e.object);const oe=e.object.zoom;e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/p)),e.object.updateProjectionMatrix(),J=oe!==e.object.zoom;const We=new O(d.x,d.y,0);We.unproject(e.object),e.object.position.sub(We).add(v),e.object.updateMatrixWorld(),k=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;k!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(k).add(e.object.position):(ae.origin.copy(e.object.position),ae.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(ae.direction))<Kt?o.lookAt(e.target):(nt.setFromNormalAndCoplanarPoint(e.object.up,e.target),ae.intersectPlane(nt,e.target))))}else if(e.object.isOrthographicCamera){const k=e.object.zoom;e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/p)),k!==e.object.zoom&&(e.object.updateProjectionMatrix(),J=!0)}return p=1,z=!1,J||h.distanceToSquared(e.object.position)>u||8*(1-w.dot(e.object.quaternion))>u||Y.distanceToSquared(e.target)>u?(e.dispatchEvent(et),h.copy(e.object.position),w.copy(e.object.quaternion),Y.copy(e.target),!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",Ze),e.domElement.removeEventListener("pointerdown",ze),e.domElement.removeEventListener("pointercancel",Q),e.domElement.removeEventListener("wheel",xe),e.domElement.removeEventListener("pointermove",ge),e.domElement.removeEventListener("pointerup",Q),e.domElement.getRootNode().removeEventListener("keydown",Ue,{capture:!0}),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",be),e._domElementKeyEvents=null)};const e=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=n.NONE;const u=1e-6,i=new Qe,c=new Qe;let p=1;const _=new O,y=new R,T=new R,b=new R,E=new R,M=new R,f=new R,A=new R,C=new R,g=new R,B=new O,d=new R;let z=!1;const P=[],q={};let de=!1;function lt(t){return t!==null?2*Math.PI/60*e.autoRotateSpeed*t:2*Math.PI/60/60*e.autoRotateSpeed}function te(t){const l=Math.abs(t*.01);return Math.pow(.95,e.zoomSpeed*l)}function G(t){c.theta-=t}function ne(t){c.phi-=t}const Ae=function(){const t=new O;return function(m,h){t.setFromMatrixColumn(h,0),t.multiplyScalar(-m),_.add(t)}}(),je=function(){const t=new O;return function(m,h){e.screenSpacePanning===!0?t.setFromMatrixColumn(h,1):(t.setFromMatrixColumn(h,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(m),_.add(t)}}(),x=function(){const t=new O;return function(m,h){const w=e.domElement;if(e.object.isPerspectiveCamera){const Y=e.object.position;t.copy(Y).sub(e.target);let j=t.length();j*=Math.tan(e.object.fov/2*Math.PI/180),Ae(2*m*j/w.clientHeight,e.object.matrix),je(2*h*j/w.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(Ae(m*(e.object.right-e.object.left)/e.object.zoom/w.clientWidth,e.object.matrix),je(h*(e.object.top-e.object.bottom)/e.object.zoom/w.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function me(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?p/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function Ce(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?p*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function pe(t,l){if(!e.zoomToCursor)return;z=!0;const m=e.domElement.getBoundingClientRect(),h=t-m.left,w=l-m.top,Y=m.width,j=m.height;d.x=h/Y*2-1,d.y=-(w/j)*2+1,B.set(d.x,d.y,1).unproject(e.object).sub(e.object.position).normalize()}function he(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function Re(t){y.set(t.clientX,t.clientY)}function ut(t){pe(t.clientX,t.clientX),A.set(t.clientX,t.clientY)}function De(t){E.set(t.clientX,t.clientY)}function ft(t){T.set(t.clientX,t.clientY),b.subVectors(T,y).multiplyScalar(e.rotateSpeed);const l=e.domElement;G(2*Math.PI*b.x/l.clientHeight),ne(2*Math.PI*b.y/l.clientHeight),y.copy(T),e.update()}function dt(t){C.set(t.clientX,t.clientY),g.subVectors(C,A),g.y>0?me(te(g.y)):g.y<0&&Ce(te(g.y)),A.copy(C),e.update()}function mt(t){M.set(t.clientX,t.clientY),f.subVectors(M,E).multiplyScalar(e.panSpeed),x(f.x,f.y),E.copy(M),e.update()}function pt(t){pe(t.clientX,t.clientY),t.deltaY<0?Ce(te(t.deltaY)):t.deltaY>0&&me(te(t.deltaY)),e.update()}function ht(t){let l=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?ne(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):x(0,e.keyPanSpeed),l=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?ne(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):x(0,-e.keyPanSpeed),l=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?G(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):x(e.keyPanSpeed,0),l=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?G(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):x(-e.keyPanSpeed,0),l=!0;break}l&&(t.preventDefault(),e.update())}function Ie(t){if(P.length===1)y.set(t.pageX,t.pageY);else{const l=U(t),m=.5*(t.pageX+l.x),h=.5*(t.pageY+l.y);y.set(m,h)}}function Le(t){if(P.length===1)E.set(t.pageX,t.pageY);else{const l=U(t),m=.5*(t.pageX+l.x),h=.5*(t.pageY+l.y);E.set(m,h)}}function Se(t){const l=U(t),m=t.pageX-l.x,h=t.pageY-l.y,w=Math.sqrt(m*m+h*h);A.set(0,w)}function gt(t){e.enableZoom&&Se(t),e.enablePan&&Le(t)}function bt(t){e.enableZoom&&Se(t),e.enableRotate&&Ie(t)}function ke(t){if(P.length==1)T.set(t.pageX,t.pageY);else{const m=U(t),h=.5*(t.pageX+m.x),w=.5*(t.pageY+m.y);T.set(h,w)}b.subVectors(T,y).multiplyScalar(e.rotateSpeed);const l=e.domElement;G(2*Math.PI*b.x/l.clientHeight),ne(2*Math.PI*b.y/l.clientHeight),y.copy(T)}function Ne(t){if(P.length===1)M.set(t.pageX,t.pageY);else{const l=U(t),m=.5*(t.pageX+l.x),h=.5*(t.pageY+l.y);M.set(m,h)}f.subVectors(M,E).multiplyScalar(e.panSpeed),x(f.x,f.y),E.copy(M)}function Ye(t){const l=U(t),m=t.pageX-l.x,h=t.pageY-l.y,w=Math.sqrt(m*m+h*h);C.set(0,w),g.set(0,Math.pow(C.y/A.y,e.zoomSpeed)),me(g.y),A.copy(C);const Y=(t.pageX+l.x)*.5,j=(t.pageY+l.y)*.5;pe(Y,j)}function yt(t){e.enableZoom&&Ye(t),e.enablePan&&Ne(t)}function Et(t){e.enableZoom&&Ye(t),e.enableRotate&&ke(t)}function ze(t){e.enabled!==!1&&(P.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",ge),e.domElement.addEventListener("pointerup",Q)),!At(t)&&(wt(t),t.pointerType==="touch"?Ke(t):_t(t)))}function ge(t){e.enabled!==!1&&(t.pointerType==="touch"?Tt(t):Pt(t))}function Q(t){switch(Ot(t),P.length){case 0:e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",ge),e.domElement.removeEventListener("pointerup",Q),e.dispatchEvent(tt),a=n.NONE;break;case 1:const l=P[0],m=q[l];Ke({pointerId:l,pageX:m.x,pageY:m.y});break}}function _t(t){let l;switch(t.button){case 0:l=e.mouseButtons.LEFT;break;case 1:l=e.mouseButtons.MIDDLE;break;case 2:l=e.mouseButtons.RIGHT;break;default:l=-1}switch(l){case H.DOLLY:if(e.enableZoom===!1)return;ut(t),a=n.DOLLY;break;case H.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;De(t),a=n.PAN}else{if(e.enableRotate===!1)return;Re(t),a=n.ROTATE}break;case H.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;Re(t),a=n.ROTATE}else{if(e.enablePan===!1)return;De(t),a=n.PAN}break;default:a=n.NONE}a!==n.NONE&&e.dispatchEvent(Ee)}function Pt(t){switch(a){case n.ROTATE:if(e.enableRotate===!1)return;ft(t);break;case n.DOLLY:if(e.enableZoom===!1)return;dt(t);break;case n.PAN:if(e.enablePan===!1)return;mt(t);break}}function xe(t){e.enabled===!1||e.enableZoom===!1||a!==n.NONE||(t.preventDefault(),e.dispatchEvent(Ee),pt(Mt(t)),e.dispatchEvent(tt))}function Mt(t){const l=t.deltaMode,m={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(l){case 1:m.deltaY*=16;break;case 2:m.deltaY*=100;break}return t.ctrlKey&&!de&&(m.deltaY*=10),m}function Ue(t){t.key==="Control"&&(de=!0,e.domElement.getRootNode().addEventListener("keyup",He,{passive:!0,capture:!0}))}function He(t){t.key==="Control"&&(de=!1,e.domElement.getRootNode().removeEventListener("keyup",He,{passive:!0,capture:!0}))}function be(t){e.enabled===!1||e.enablePan===!1||ht(t)}function Ke(t){switch(Xe(t),P.length){case 1:switch(e.touches.ONE){case K.ROTATE:if(e.enableRotate===!1)return;Ie(t),a=n.TOUCH_ROTATE;break;case K.PAN:if(e.enablePan===!1)return;Le(t),a=n.TOUCH_PAN;break;default:a=n.NONE}break;case 2:switch(e.touches.TWO){case K.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;gt(t),a=n.TOUCH_DOLLY_PAN;break;case K.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;bt(t),a=n.TOUCH_DOLLY_ROTATE;break;default:a=n.NONE}break;default:a=n.NONE}a!==n.NONE&&e.dispatchEvent(Ee)}function Tt(t){switch(Xe(t),a){case n.TOUCH_ROTATE:if(e.enableRotate===!1)return;ke(t),e.update();break;case n.TOUCH_PAN:if(e.enablePan===!1)return;Ne(t),e.update();break;case n.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;yt(t),e.update();break;case n.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Et(t),e.update();break;default:a=n.NONE}}function Ze(t){e.enabled!==!1&&t.preventDefault()}function wt(t){P.push(t.pointerId)}function Ot(t){delete q[t.pointerId];for(let l=0;l<P.length;l++)if(P[l]==t.pointerId){P.splice(l,1);return}}function At(t){for(let l=0;l<P.length;l++)if(P[l]==t.pointerId)return!0;return!1}function Xe(t){let l=q[t.pointerId];l===void 0&&(l=new R,q[t.pointerId]=l),l.set(t.pageX,t.pageY)}function U(t){const l=t.pointerId===P[0]?P[1]:P[0];return q[l]}e.domElement.addEventListener("contextmenu",Ze),e.domElement.addEventListener("pointerdown",ze),e.domElement.addEventListener("pointercancel",Q),e.domElement.addEventListener("wheel",xe,{passive:!1}),e.domElement.getRootNode().addEventListener("keydown",Ue,{passive:!0,capture:!0}),this.update()}};const Xt=s=>({ref:s&1}),ot=s=>({ref:s[0]});function Ft(s){let o;const r=s[6].default,e=ie(r,s,s[8],ot);return{c(){e&&e.c()},l(n){e&&e.l(n)},m(n,a){e&&e.m(n,a),o=!0},p(n,a){e&&e.p&&(!o||a&257)&&re(e,r,n,n[8],o?le(r,n[8],a,Xt):ce(n[8]),ot)},i(n){o||(D(e,n),o=!0)},o(n){I(e,n),o=!1},d(n){e&&e.d(n)}}}function Wt(s){let o,r;const e=[{is:s[0]},s[5]];let n={$$slots:{default:[Ft,({ref:a})=>({0:a}),({ref:a})=>a?1:0]},$$scope:{ctx:s}};for(let a=0;a<e.length;a+=1)n=N(n,e[a]);return o=new ee({props:n}),s[7](o),o.$on("change",s[3]),{c(){X(o.$$.fragment)},l(a){F(o.$$.fragment,a)},m(a,u){W(o,a,u),r=!0},p(a,[u]){const i=u&33?Te(e,[u&1&&{is:a[0]},u&32&&we(a[5])]):{};u&257&&(i.$$scope={dirty:u,ctx:a}),o.$set(i)},i(a){r||(D(o.$$.fragment,a),r=!0)},o(a){I(o.$$.fragment,a),r=!1},d(a){s[7](null),V(o,a)}}}function Vt(s,o,r){const e=["ref"];let n=Z(o,e),a,u,{$$slots:i={},$$scope:c}=o;const p=Yt();$(s,p,g=>r(9,a=g));const _=g=>g.isCamera,{renderer:y,invalidate:T}=zt();if(!_(a))throw new Error("Parent missing: <OrbitControls> need to be a child of a <Camera>");const b=new Zt(a,y.domElement),{start:E,stop:M}=rt(b.update,{autoStart:!1,autoInvalidate:!1}),f=Oe();$(s,f,g=>r(1,u=g));const{orbitControls:A}=xt();A.set(b),it(()=>A.set(void 0));function C(g){Me[g?"unshift":"push"](()=>{u=g,f.set(u)})}return s.$$set=g=>{o=N(N({},o),Pe(g)),r(5,n=Z(o,e)),"$$scope"in g&&r(8,c=g.$$scope)},s.$$.update=()=>{n.autoRotate||n.enableDamping?E():M()},[b,u,p,T,f,n,i,C,c]}class hn extends ue{constructor(o){super(),fe(this,o,Vt,Wt,se,{ref:0})}get ref(){return this.$$.ctx[0]}}const ct=s=>`threlte-instanced-mesh-${s}`,Bt=(s,o)=>{const r={instancedMesh:Je(s),addInstance(e){r.instances.update(n=>(n.push(e),n))},removeInstance(e){r.instances.update(n=>{const a=n.indexOf(e);return a>-1&&n.splice(a,1),n})},instances:Je([])};return Rt(ct(o),r),r},qt=s=>{const o=Ct(ct(s));if(!o)throw new Error(`No <InstancedMesh> component found for id ${s}`);return o};function Gt(s){let o,r,e,n,a;o=new ee.InstancedBufferAttribute({props:{attach:"instanceMatrix",count:s[1].length/16,array:s[1],itemSize:16,usage:ve}}),e=new ee.InstancedBufferAttribute({props:{attach:"instanceColor",count:s[2].length/3,array:s[2],itemSize:3,usage:ve}});const u=s[10].default,i=ie(u,s,s[9],null);return{c(){X(o.$$.fragment),r=Ve(),X(e.$$.fragment),n=Ve(),i&&i.c()},l(c){F(o.$$.fragment,c),r=Be(c),F(e.$$.fragment,c),n=Be(c),i&&i.l(c)},m(c,p){W(o,c,p),qe(c,r,p),W(e,c,p),qe(c,n,p),i&&i.m(c,p),a=!0},p(c,[p]){i&&i.p&&(!a||p&512)&&re(i,u,c,c[9],a?le(u,c[9],p,null):ce(c[9]),null)},i(c){a||(D(o.$$.fragment,c),D(e.$$.fragment,c),D(i,c),a=!0)},o(c){I(o.$$.fragment,c),I(e.$$.fragment,c),I(i,c),a=!1},d(c){c&&(Ge(r),Ge(n)),V(o,c),V(e,c),i&&i.d(c)}}}function Qt(s,o,r){let e,{$$slots:n={},$$scope:a}=o,{instancedMesh:u}=o,{id:i}=o,{limit:c}=o,{range:p}=o,{update:_}=o;const{instances:y}=Bt(u,i);$(s,y,d=>r(8,e=d));const T=new ye,b=new Float32Array(c*16);for(let d=0;d<c;d++)T.identity().toArray(b,d*16);const E=new Float32Array(c*3).fill(1),M=new ye,f=new ye,A=new O,C=new _e,g=new O;let B=!1;return rt(()=>{if(u.updateMatrix(),_||!B){u.updateMatrixWorld(),M.copy(u.matrixWorld).invert(),u.instanceColor&&r(3,u.instanceColor.needsUpdate=!0,u),r(3,u.instanceMatrix.needsUpdate=!0,u);for(let d=0;d<y.current.length;d++){const z=y.current[d];z.matrixWorld.decompose(A,C,g),f.compose(A,C,g).premultiply(M),f.toArray(b,d*16),z.color.toArray(E,d*3)}B=!0}}),s.$$set=d=>{"instancedMesh"in d&&r(3,u=d.instancedMesh),"id"in d&&r(4,i=d.id),"limit"in d&&r(5,c=d.limit),"range"in d&&r(6,p=d.range),"update"in d&&r(7,_=d.update),"$$scope"in d&&r(9,a=d.$$scope)},s.$$.update=()=>{if(s.$$.dirty&360){const d=Math.min(c,p!==void 0?p:c,e.length);r(3,u.count=d,u),$e>=159?(u.instanceMatrix.clearUpdateRanges(),u.instanceMatrix.addUpdateRange(0,d*16)):r(3,u.instanceMatrix.updateRange.count=d*16,u),u.instanceColor&&($e>=159?(u.instanceColor.clearUpdateRanges(),u.instanceColor.addUpdateRange(0,d*3)):r(3,u.instanceColor.updateRange.count=d*3,u))}},[y,b,E,u,i,c,p,_,e,a,n]}class Jt extends ue{constructor(o){super(),fe(this,o,Qt,Gt,se,{instancedMesh:3,id:4,limit:5,range:6,update:7})}}const vt=s=>({}),at=s=>({ref:s[4]});function $t(s){let o;const r=s[9].default,e=ie(r,s,s[11],at);return{c(){e&&e.c()},l(n){e&&e.l(n)},m(n,a){e&&e.m(n,a),o=!0},p(n,a){e&&e.p&&(!o||a&2048)&&re(e,r,n,n[11],o?le(r,n[11],a,vt):ce(n[11]),at)},i(n){o||(D(e,n),o=!0)},o(n){I(e,n),o=!1},d(n){e&&e.d(n)}}}function en(s){let o,r;return o=new Jt({props:{instancedMesh:s[4],id:s[0],limit:s[1],range:s[2],update:s[3],$$slots:{default:[$t]},$$scope:{ctx:s}}}),{c(){X(o.$$.fragment)},l(e){F(o.$$.fragment,e)},m(e,n){W(o,e,n),r=!0},p(e,n){const a={};n&1&&(a.id=e[0]),n&2&&(a.limit=e[1]),n&4&&(a.range=e[2]),n&8&&(a.update=e[3]),n&2048&&(a.$$scope={dirty:n,ctx:e}),o.$set(a)},i(e){r||(D(o.$$.fragment,e),r=!0)},o(e){I(o.$$.fragment,e),r=!1},d(e){V(o,e)}}}function tn(s){let o,r,e;const n=[{is:s[4]},{raycast:nn},{matrixAutoUpdate:!1},{args:s[7]},s[8]];function a(i){s[10](i)}let u={$$slots:{default:[en]},$$scope:{ctx:s}};for(let i=0;i<n.length;i+=1)u=N(u,n[i]);return s[5]!==void 0&&(u.bind=s[5]),o=new ee({props:u}),Me.push(()=>It(o,"bind",a)),{c(){X(o.$$.fragment)},l(i){F(o.$$.fragment,i)},m(i,c){W(o,i,c),e=!0},p(i,[c]){const p=c&400?Te(n,[c&16&&{is:i[4]},n[1],n[2],c&128&&{args:i[7]},c&256&&we(i[8])]):{};c&2063&&(p.$$scope={dirty:c,ctx:i}),!r&&c&32&&(r=!0,p.bind=i[5],Dt(()=>r=!1)),o.$set(p)},i(i){e||(D(o.$$.fragment,i),e=!0)},o(i){I(o.$$.fragment,i),e=!1},d(i){V(o,i)}}}const nn=()=>null;function on(s,o,r){const e=["id","limit","range","update","ref"];let n=Z(o,e),a,{$$slots:u={},$$scope:i}=o,{id:c="default"}=o,{limit:p=1e3}=o,{range:_=1e3}=o,{update:y=!0}=o;const T=new Ut(null,null,0),b=Oe();$(s,b,f=>r(5,a=f));const E=[null,null,0];function M(f){a=f,b.set(a)}return s.$$set=f=>{o=N(N({},o),Pe(f)),r(8,n=Z(o,e)),"id"in f&&r(0,c=f.id),"limit"in f&&r(1,p=f.limit),"range"in f&&r(2,_=f.range),"update"in f&&r(3,y=f.update),"$$scope"in f&&r(11,i=f.$$scope)},[c,p,_,y,T,a,b,E,n,u,M,i]}class gn extends ue{constructor(o){super(),fe(this,o,on,tn,se,{id:0,limit:1,range:2,update:3,ref:4})}get ref(){return this.$$.ctx[4]}}const an=s=>({}),st=s=>({ref:s[0]});function sn(s){let o;const r=s[5].default,e=ie(r,s,s[7],st);return{c(){e&&e.c()},l(n){e&&e.l(n)},m(n,a){e&&e.m(n,a),o=!0},p(n,a){e&&e.p&&(!o||a&128)&&re(e,r,n,n[7],o?le(r,n[7],a,an):ce(n[7]),st)},i(n){o||(D(e,n),o=!0)},o(n){I(e,n),o=!1},d(n){e&&e.d(n)}}}function rn(s){let o,r;const e=[{is:s[0]},s[3]];let n={$$slots:{default:[sn]},$$scope:{ctx:s}};for(let a=0;a<e.length;a+=1)n=N(n,e[a]);return o=new ee({props:n}),s[6](o),{c(){X(o.$$.fragment)},l(a){F(o.$$.fragment,a)},m(a,u){W(o,a,u),r=!0},p(a,[u]){const i=u&9?Te(e,[u&1&&{is:a[0]},u&8&&we(a[3])]):{};u&128&&(i.$$scope={dirty:u,ctx:a}),o.$set(i)},i(a){r||(D(o.$$.fragment,a),r=!0)},o(a){I(o.$$.fragment,a),r=!1},d(a){s[6](null),V(o,a)}}}function cn(s,o,r){const e=["id","ref"];let n=Z(o,e),a,{$$slots:u={},$$scope:i}=o,{id:c="default"}=o;const{addInstance:p,removeInstance:_,instancedMesh:y,instances:T}=qt(c),b=new Ht(y,T);p(b),it(()=>{_(b)});const E=Oe();$(s,E,f=>r(1,a=f));function M(f){Me[f?"unshift":"push"](()=>{a=f,E.set(a)})}return s.$$set=f=>{o=N(N({},o),Pe(f)),r(3,n=Z(o,e)),"id"in f&&r(4,c=f.id),"$$scope"in f&&r(7,i=f.$$scope)},[b,a,E,n,c,u,M,i]}class bn extends ue{constructor(o){super(),fe(this,o,cn,rn,se,{id:4,ref:0})}get ref(){return this.$$.ctx[0]}}export{gn as I,hn as O,bn as a};
